.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.14
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "INND 8"
.TH INND 8 "2004-05-16" "INN 2.5.0" "InterNetNews Documentation"
.SH "NAME"
innd \- InterNetNews daemon
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBinnd\fR [\fB\-aCdfNrsu\fR] [\fB\-6\fR \fIaddress\fR] [\fB\-c\fR \fIdays\fR] [\fB\-H\fR \fIcount\fR]
[\fB\-i\fR \fIcount\fR] [\fB\-I\fR\ \fIaddress\fR] [\fB\-l\fR \fIsize\fR] [\fB\-m\fR \fImode\fR]
[\fB\-n\fR \fIflag\fR] [\fB\-o\fR \fIcount\fR] [\fB\-P\fR \fIport\fR] [\fB\-t\fR\ \fItimeout\fR]
[\fB\-T\fR \fIcount\fR] [\fB\-X\fR \fIseconds\fR]
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBinnd\fR, the InterNetNews daemon, handles all incoming \s-1NNTP\s0 feeds,
coordinates the storage, retransmission, and overview generation for all
accepted articles, and manages the \fIactive\fR\|(5) and \fIhistory\fR\|(5) databases.  It
handles incoming connections on the \s-1NNTP\s0 port, and also creates and
listens to a local Unix-domain stream socket in order to receive articles
from local processes such as \fInnrpd\fR\|(8) and \fIrnews\fR\|(1).
.PP
As the master daemon, \fBinnd\fR should generally be started at boot and be
always running.  It listens to a Unix-domain datagram socket for commands
to control its activites, commands that can be sent using \fIctlinnd\fR\|(8).  The
current status of \fBinnd\fR can be obtained by running \f(CW\*(C`ctlinnd mode\*(C'\fR, or
for more detailed output, \fIinnstat\fR\|(8).
.PP
\&\fBinnd\fR can be in one of three operating modes:  running, paused, or
throttled.  Running is the normal mode; when the server is throttled, it
closes connections and rejects new ones.  Paused is like a temporary
throttle, suspending \fBinnd\fR's activities but not causing the server to
shut down existing connections.  The mode is normally changed via
\&\fIctlinnd\fR\|(8), either by various automated processes (such as nightly article
expiration) or manually by the news administrator, but \fBinnd\fR will also
throttle itself if it encounters \s-1ENOSPC\s0 errors in writing data or an
excessive number of I/O errors (among other problems).
.PP
\&\fBinnd\fR normally takes care of spawning \fInnrpd\fR\|(8) to handle connections
from news reading clients, but it can be run on a separate port from
\&\fInnrpd\fR\|(8) so that feed connections and news reading connections are handled
separately (this can often be faster).  Normally, \fBinnd\fR listens on port
119, the assigned port for \s-1NNTP\s0; if it is desireable to run \fBinnd\fR and
\&\fInnrpd\fR\|(8) on separate ports, it's recommended that \fInnrpd\fR\|(8) be given port
119 (since many news reading clients connect only to that port) and that
port 433 be used for \fBinnd\fR.
.PP
The primary configuration files that control \fBinnd\fR's activities are
\&\fIincoming.conf\fR, which specifies what remote sites \fBinnd\fR will accept
connections from, \fInewsfeeds\fR, which specifies what is to be done with
incoming articles besides storing them, and \fIinn.conf\fR, which sets a wide
variety of configuration parameters.  Some parameters in \fIinn.conf\fR\|(5) can
also be set with command-line flags; for these, the command-line flags
take precedence if used.
.PP
\&\fBinnd\fR must be run as the news user and news group.  It will check for
this at startup and fail to start if not run properly.  Normally it should
be started via \fIrc.news\fR\|(8) as part of the system bootup process.  It relies
on the setuid root helper program \fIinnbind\fR\|(8) to listen on a privileged
port (119 or 433).
.SH "OPTIONS"
.IX Header "OPTIONS"
For the options below that override \fIinn.conf\fR settings, see \fIinn.conf\fR\|(5)
for the default values if neither the \fIinn.conf\fR setting nor the
command-line option is given.
.IP "\fB\-6\fR \fIaddress\fR" 4
.IX Item "-6 address"
Only applies when \s-1INN\s0 has been built with IPv6 support.  Normally \fBinnd\fR
binds to all local \s-1IP\s0 addresses (unless \fIbindaddress6\fR is set in
\&\fIinn.conf\fR).  If this option is given, it specifies the IPv6 address that
\&\s-1INN\s0 should bind to.  The IPv6 address must be in colon-separated \s-1RFC\s0 2373
format (\f(CW\*(C`n:n:n:n:n:n:n:n\*(C'\fR).
.Sp
If this option is specified, it's the same as setting \fIbindaddress6\fR in
\&\fIinn.conf\fR and may cause changes in whether \s-1INN\s0 binds to an IPv4 address
as well.  See \fIinn.conf\fR\|(5) for more details.
.IP "\fB\-a\fR" 4
.IX Item "-a"
By default, if a host connects to \fBinnd\fR but is not listed in
\&\fIincoming.conf\fR, the connection is handed off to \fBnnrpd\fR (or rejected if
\&\fInoreader\fR is set in \fIinn.conf\fR).  If \fB\-a\fR is given, \fIincoming.conf\fR
is ignored and any host can connect and transfer articles.  This flag
should never be used with an accessible server connected to Usenet; it
would open the server up for all sorts of abuse.
.IP "\fB\-c\fR \fIdays\fR" 4
.IX Item "-c days"
\&\fBinnd\fR normally rejects any article that is older (in days) than the
value of \fIartcutoff\fR in \fIinn.conf\fR.  This option, if given, overrides
the value of that setting.  If \fIdays\fR is 0, this check is suppressed and
\&\fBinnd\fR will accept articles regardless of how old they are.
.IP "\fB\-C\fR" 4
.IX Item "-C"
This flag tells \fBinnd\fR to accept and propagate but not actually process
cancel or supersede messages.  This is intended for sites concerned about
abuse of cancels, or that wish to use another cancel mechanism with
stronger authentication.
.IP "\fB\-d\fR, \fB\-f\fR" 4
.IX Item "-d, -f"
\&\fBinnd\fR normally puts itself into the background, points its standard
output and error to log files, and disassociates itself from the
terminal.  Using \fB\-d\fR prevents all of this, resulting in log messages
being written to standard output; this is generally useful only for
debugging.  Using \fB\-f\fR prevents the backgrounding and disassociation but
still redirects output; it may be useful if you want to monitor \fBinnd\fR
with a program that would be confused by forks.
.IP "\fB\-H\fR \fIcount\fR, \fB\-T\fR \fIcount\fR, \fB\-X\fR \fIseconds\fR" 4
.IX Item "-H count, -T count, -X seconds"
These flags control the number of connections per minute that are allowed.
This code is meant to protect your server from newsreader clients that
make too many connections per minute (and therefore these flags are
probably only useful when \fBinnd\fR is spawning \fBnnrpd\fR).  You probably
should not use these options unless you're having problems.  The table
used for this check is fixed at 128 entries and is used as a ring; the
size was chosen to make calculating the index easy and to be fairly sure
that it won't run out of space.  In practice, it is unlikely that even
half the table will be used at any given moment.
.Sp
The \fB\-H\fR flag limits the number of times a host is allowed to connect to
the server per the time interval given by \fB\-X\fR.  The default is \f(CW2\fR.
.Sp
The \fB\-T\fR flag limits the total number of incoming connections per the
time interval given by \fB\-X\fR.  The maximum value is \f(CW128\fR, and the
default is \f(CW60\fR.
.IP "\fB\-i\fR \fIcount\fR" 4
.IX Item "-i count"
\&\fBinnd\fR normally allows a maximum number of concurrent \s-1NNTP\s0 connections
given by the value of \fImaxconnections\fR in \fIinn.conf\fR.  This option, if
given, overrides the value of that setting.  If \fIcount\fR is \f(CW0\fR, this
check is suppressed.
.IP "\fB\-I\fR \fIaddress\fR" 4
.IX Item "-I address"
Normally \fBinnd\fR binds to all local \s-1IP\s0 addresses (unless \fIbindaddress\fR is
set in \fIinn.conf\fR).  If this option is given, it specifies the \s-1IP\s0 address
that \s-1INN\s0 should bind as.  This is only relevant for servers with multiple
local \s-1IP\s0 addresses.  The \s-1IP\s0 address must be in dotted quad
(\f(CW\*(C`nnn.nnn.nnn.nnn\*(C'\fR) format.
.Sp
If this option is specified, it's the same as setting \fIbindaddress\fR in
\&\fIinn.conf\fR and may cause changes in whether \s-1INN\s0 binds to an IPv6 address
as well.  See \fIinn.conf\fR\|(5) for more details.
.IP "\fB\-l\fR \fIsize\fR" 4
.IX Item "-l size"
\&\fBinnd\fR normally rejects any article larger than the value of
\&\fImaxartsize\fR in \fIinn.conf\fR.  This option, if given, overrides the value
of that setting and specifies a maximum article size of \fIsize\fR.  If
\&\fIsize\fR is \f(CW0\fR, this check is suppressed.
.IP "\fB\-m\fR \fImode\fR" 4
.IX Item "-m mode"
Normally \fBinnd\fR starts in the \f(CW\*(C`running\*(C'\fR mode.  If this option is given,
it specifies what mode \fBinnd\fR should start in.  \fImode\fR should begin with
one of \f(CW\*(C`g\*(C'\fR, \f(CW\*(C`p\*(C'\fR, or \f(CW\*(C`t\*(C'\fR, and the starting mode will be set to
\&\f(CW\*(C`running\*(C'\fR, \f(CW\*(C`paused\*(C'\fR, or \f(CW\*(C`throttled\*(C'\fR, respectively, based on that
initial letter.  (\f(CW\*(C`g\*(C'\fR is short for \f(CW\*(C`go\*(C'\fR.)
.IP "\fB\-N\fR" 4
.IX Item "-N"
If this option is given, any filters (Perl or Python) are disabled before
\&\fBinnd\fR starts (normally, filters default to being enabled).  The filters
can be enabled after \fBinnd\fR has started with \fIctlinnd\fR\|(8).
.IP "\fB\-n\fR \fIflag\fR" 4
.IX Item "-n flag"
Whether \fBinnd\fR allows (and hands off to \fBnnrpd\fR) reader connections
while paused or throttled is normally determined by the value of
\&\fIreaderswhenstopped\fR in \fIinn.conf\fR).  This option, if given, overrides
that value.  If \fIflag\fR is \f(CW\*(C`n\*(C'\fR, \fBinnd\fR will not allow readers if it is
paused or throttled.  If \fIflag\fR is \f(CW\*(C`y\*(C'\fR, readers will be allowed
regardless of \fBinnd\fR's operating mode.
.IP "\fB\-o\fR \fIcount\fR" 4
.IX Item "-o count"
This flag limits the number of file descriptors that are available for
outgoing file feeds.  The default is the number of available file
descriptors minus some reserved for internal use (which could potentially
starve \fBinnd\fR of descriptors to use for accepting new connections).  If
\&\fBinnd\fR has more file feeds than \fIcount\fR, some of them will be buffered
and only written out periodically.
.Sp
Normally you never need to use this option, since the number of outgoing
feeds is fixed, being the number of file feeds configured in \fInewsfeeds\fR,
and is generally small (particularly given that \fIinnfeed\fR\|(8) is now used for
most outgoing feeds at large sites).
.IP "\fB\-P\fR \fIport\fR" 4
.IX Item "-P port"
The port \fBinnd\fR should listen on is normally given by the value of
\&\fIport\fR in \fIinn.conf\fR.  This option, if given, overrides that value and
specifies the port that \fBinnd\fR should bind to.
.IP "\fB\-r\fR" 4
.IX Item "-r"
Instructs \fBinnd\fR to renumber the \fIactive\fR file after starting, just as
if a \f(CW\*(C`ctlinnd renumber\*(C'\fR command were sent.
.IP "\fB\-s\fR" 4
.IX Item "-s"
Just check the syntax of the \fInewsfeeds\fR file and exit.  \fBinnd\fR will
exit with a non-zero status if any errors are found; the actual errors
will be reported via \fIsyslog\fR\|(3).
.IP "\fB\-t\fR \fIseconds\fR" 4
.IX Item "-t seconds"
Normally, \fBinnd\fR will flush any changes to history and the active file
after 300 seconds of inactivity.  This option changes that timeout to
\&\fIseconds\fR.
.IP "\fB\-u\fR" 4
.IX Item "-u"
The news log (the trace information for every article accepted by \fBinnd\fR)
is normally buffered.  This option changes the log to be unbuffered.
.SH "CONTROL MESSAGES"
.IX Header "CONTROL MESSAGES"
Arriving articles that have a Control header are called \*(L"control
messages\*(R".  Except for cancel messages, these messages are handled by
\&\fIcontrolchan\fR\|(8) via a feed set up in \fInewsfeeds\fR.
.PP
(Cancel messages update the history database, so they must be handled
internally; the cost of syncing, locking, then unlocking would be too high
given the number of cancel messages that are received.)
.PP
The distribution of control messages is different than that of standard
articles.  Control messages are normally filed into the pseudo-newsgroup
named \f(CW\*(C`control\*(C'\fR regardless of which newsgroup they were actually posted
to.  If, however, a \f(CW\*(C`control.\*(C'\fR\fIcommand\fR newsgroup exists that matches
the control command, the control message will be filed into that group
instead.  For example, a newgroup control message will be filed in
\&\f(CW\*(C`control.newgroup\*(C'\fR if that group exists; otherwise, it will be filed in
\&\f(CW\*(C`control\*(C'\fR.
.PP
If you want to specifically feed all control messages to a given site
regardless of whether the control messages would affect the newsgroups
you're feeding that site, you can put the appropriate control newsgroup in
the subscription list.  For example, to feed all cancel messages to a
given remote site (normally a bad idea), add \f(CW\*(C`control.cancel\*(C'\fR to its
subscription list.  Normally it's best to exclude the control newsgroups
from feeds to keep from sending your peers more control messages than they
care about.
.PP
newgroup and rmgroup control messages receive additional special
treatment.  If one of these control messages is approved and posted to the
newsgroup being created or removed, the message will be sent to all sites
whose subscription patterns would cause them to receive articles posted to
that group.  For example, if a newgroup control message for a nonexistent
newsgroup \f(CW\*(C`news.admin.meow\*(C'\fR is received, it will be sent to any site
whose subscription pattern would cause it to receive \f(CW\*(C`news.admin.meow\*(C'\fR if
that newsgroup existed (such as a pattern of \f(CW\*(C`news.admin.*\*(C'\fR).  For this
reason, it is correct to post newgroup messages to the newsgroup that the
control message would create.  It is \fInot\fR generally correct to crosspost
newgroup messages to some \*(L"well\-propagated\*(R" newsgroup; not only will this
not actually improve their propagation to sites that want such control
messages, but it will also cause sites that do not want those control
messages to receive them.
.PP
If a control message is posted to a group whose name ends with the four
characters \f(CW\*(C`.ctl\*(C'\fR, this suffix is stripped off and the control message is
propagated as if it were posted to the base group.  For example, a cancel
message posted to \f(CW\*(C`news.admin.ctl\*(C'\fR will be sent to all sites that
subscribe to \f(CW\*(C`control.cancel\*(C'\fR (or \f(CW\*(C`control\*(C'\fR if that newsgroup doesn't
exist) or \f(CW\*(C`news.admin\*(C'\fR.  This behavior is present for historical
compatibility reasons and should be considered obsolete; support for the
\&\f(CW\*(C`.ctl\*(C'\fR suffix may be removed in a future version of \s-1INN\s0.
.PP
Finally, articles posted to newsgroups beginning with \f(CW\*(C`to.\*(C'\fR are treated
specially.  Provided that either that newsgroup exists in the active file
or \fImergetogroups\fR is set in \fIinn.conf\fR, the remainder of the newsgroup
is taken to be a site name, as configured in \fInewsfeeds\fR, and the article
is sent to that site.  If \fImergetogroups\fR is set, the article will be
filed in the group named \f(CW\*(C`to\*(C'\fR (which must exist in the active file).  For
example, with \fImergetogroups\fR set, an article posted to \f(CW\*(C`to.uunet\*(C'\fR will
be filed in \f(CW\*(C`to\*(C'\fR and sent to the site \f(CW\*(C`uunet\*(C'\fR.
.SH "PROTOCOL DIFFERENCES"
.IX Header "PROTOCOL DIFFERENCES"
\&\fBinnd\fR implements the \s-1NNTP\s0 commands defined in \s-1RFC\s0 977, with the
following differences:
.IP "1." 4
The \s-1LIST\s0 command may be followed by an optional \s-1ACTIVE\s0, \s-1ACTIVE\s0.TIMES, or
\&\s-1NEWSGROUPS\s0.  There is only basic support for \s-1LIST\s0 in \fBinnd\fR since feeding
peers normally don't need it; see \fInnrpd\fR\|(8) for full support.
.IP "2." 4
The \s-1AUTHINFO\s0 \s-1USER\s0 and \s-1AUTHINFO\s0 \s-1PASS\s0 commands are implemented, although the
authentication is currently limited to matching a password for a given
peer specified in \fIincoming.conf\fR.  These are based on the reference Unix
implementation.
.IP "3." 4
A new command, \s-1MODE\s0 \s-1READER\s0, is implemented.  This command will cause the
server to pass the connection to \fBnnrpd\fR.
.IP "4." 4
The streaming extension (\s-1MODE\s0 \s-1STREAM\s0, \s-1CHECK\s0, and \s-1TAKETHIS\s0) is fully
supported.
.IP "5." 4
A batch transfer command, \s-1XBATCH\s0 \fIbyte-count\fR, is provided.  This command
will read \fIbyte-count\fR bytes and store them for later processing by
\&\fIrnews\fR\|(1) (which must be run separately, probably from cron).  See
\&\fIinnxbatch\fR\|(8) and \fIbackends/sendxbatches\fR for more details on this
extension.
.IP "6." 4
\&\fBinnd\fR implements a limited subset of the protocol useful for
transferring news.  The only other commands implemented are \s-1HEAD\s0, \s-1HELP\s0,
\&\s-1IHAVE\s0, \s-1STAT\s0, and \s-1QUIT\s0.  The remaining commands are mostly only useful for
readers and are implemented by \fInnrpd\fR\|(8).
.SH "HEADER MODIFICATIONS"
.IX Header "HEADER MODIFICATIONS"
\&\fBinnd\fR modifies as few article headers as possible, although it could be
better in this area.
.PP
Empty headers and headers that consist of nothing but whitespace are
dropped.
.PP
The local site's name (as set with the \fIpathhost\fR parameter in
\&\fIinn.conf\fR) and an exclamation point are prepended to the Path: header,
provided the first site name in the Path: header is different from the
local one.  In addition, \fIpathalias\fR may be similarly prepended to the
Path: header; see \fIinn.conf\fR\|(5) for the details.
.PP
The Xref: header is removed and a new one created.
.PP
A Lines: header will be added if the article was missing one.
.PP
\&\fBinnd\fR does not rewrite incorrect headers.  For example, it will not
replace an incorrect Lines header, though it may reject such an article
depending on the value of \fIlinecountfuzz\fR in \fIinn.conf\fR.
.SH "CANCEL FEEDS"
.IX Header "CANCEL FEEDS"
In order to efficiently apply a large number of local cancels (such as
from processing NoCeMs or from some other external source), \s-1INN\s0 supports a
special feed mode available only to connections to the local Unix domain
socket (not to connections to any network sockets).
.PP
To enter this mode, connect to the Unix domain socket (\fIpathrun\fR/nntpin)
and send the command \s-1MODE\s0 \s-1CANCEL\s0.  The response will have code \f(CW284\fR.
Every subsequent line sent on that connection should consist of a single
message \s-1ID\s0.  An attempt will be made to cancel that message \s-1ID\s0, and the
server will reply \f(CW289\fR for success or \f(CW484\fR for failure.  (Failure can
occur, for example, if the server is paused or throttled, or the
Message-ID is corrupt.  Failure does \fInot\fR occur if the article to be
cancelled does not exist.)
.SH "LOGGING"
.IX Header "LOGGING"
\&\fBinnd\fR reports all incoming articles in its log file (\fIpathlog\fR/news).
This is a text file with a variable number of space-separated fields in
one of the following formats:
.PP
.Vb 5
\&    mon dd hh:mm:ss.mmm + feed <message-id> site ...
\&    mon dd hh:mm:ss.mmm j feed <message-id> site ...
\&    mon dd hh:mm:ss.mmm c feed <message-id> Cancelling <message-id>
\&    mon dd hh:mm:ss.mmm - feed <message-id> reason
\&    mon dd hh:mm:ss.mmm ? feed <message-id> reason
.Ve
.PP
There may also be hostname and/or size fields after the message \s-1ID\s0
depending on the settings of \fInntplinklog\fR and \fIlogartsize\fR in
\&\fIinn.conf\fR.
.PP
The first three fields are the date and time to millisecond resolution.
The fifth field is the site that sent the article (based on the Path
header) and the sixth field is the article's message \s-1ID\s0; they will be a
question mark if the information is not available.
.PP
The fourth field indicates whether the article was accepted or not.  If it
is a plus sign, then the article was accepted.  If it is the letter \f(CW\*(C`j\*(C'\fR
then the article was accepted, but all of the newsgroups to which the
article was posted were set to mode \f(CW\*(C`j\*(C'\fR in the active file (or not listed
in the active file and \fIwanttrash\fR was set in \fIinn.conf\fR) so the article
was filed into the \f(CW\*(C`junk\*(C'\fR newsgroup.  In both of these cases, the article
has been accepted and the \f(CW\*(C`site ...\*(C'\fR field contains the space-separated
list of sites to which the article is being sent.
.PP
If the fourth field is the letter \f(CW\*(C`c\*(C'\fR, then a cancel message was accepted
before the original article arrived, and a history entry for the cancelled
message was created so that \fBinnd\fR will reject that message if it arrives
later.
.PP
If the fourth field is a minus sign, then the article was rejected.  The
reasons for rejection generated by \fBinnd\fR include:
.PP
.Vb 20
\&    "%s" header too long
\&    "%s" wants to cancel <%s> by "%s"
\&    Article exceeds local limit of %s bytes
\&    Article posted in the future -- "%s"
\&    Bad "%s" header
\&    Can't write history
\&    Duplicate
\&    Duplicate "%s" header
\&    EOF in headers
\&    Linecount %s != %s +- %s
\&    Missing %s header
\&    No body
\&    No colon-space in "%s" header
\&    No space
\&    Space before colon in "%s" header
\&    Too old -- "%s"
\&    Unapproved for "%s"
\&    Unwanted newsgroup "%s"
\&    Unwanted distribution "%s"
\&    Whitespace in "Newsgroups" header -- "%s"
.Ve
.PP
where \f(CW%s\fR, above, is replaced by more specific information.  (The Perl
and Python filters, if used, may reject articles with other reasons.)
.PP
If the fourth field is the letter \f(CW\*(C`?\*(C'\fR, the article contains strange
strings, such as \s-1CR\s0 without \s-1LF\s0 or \s-1LF\s0 without \s-1CR\s0.  (These characters should
never occur in isolation, only together as \s-1CRLF\s0 to indicate the end of a
line.)  This log message is just informational, to give an idea of how
widespread such articles are; \fBinnd\fR does not reject such articles.
.PP
Note that when \fIwanttrash\fR is set to true in \fIinn.conf\fR and an article
is received that isn't posted to any valid newsgroups, it will be accepted
and logged with two lines, a \f(CW\*(C`j\*(C'\fR line and a minus sign line.
.PP
\&\fBinnd\fR also makes extensive reports through \fIsyslog\fR\|(3).  The first word of
the log message will be the name of the site if the entry is site-specific
(such as a \*(L"connected\*(R" message).  The first word will be \f(CW\*(C`SERVER\*(C'\fR if the
message relates to the server itself, such as when a read error occurs.
.PP
If the second word is the four letters \f(CW\*(C`cant\*(C'\fR, then an error is being
reported.  (The absence of an apostrophe is intentional; it makes it
easier to grep from the command line and easier to find error messages in
FAQs using a search engine.)  In this case, the next two words generally
name the system call or library routine that failed and the object upon
which the action was being performed.  The rest of the line may contain
other information.
.PP
In other cases, the second word attempts to summarize what change has been
made, while the rest of the line gives more specific information.  The
word \f(CW\*(C`internal\*(C'\fR generally indicates an internal logic error.
.SH "SIGNALS"
.IX Header "SIGNALS"
\&\fBinnd\fR will catch \s-1SIGTERM\s0 and \s-1SIGHUP\s0 and shut down.  If \fB\-d\fR is used,
\&\s-1SIGINT\s0 will also be caught and will result in an orderly shutdown.
.PP
\&\fBinnd\fR will catch the \s-1SIGUSR1\s0 signal and recreate the control channel
used by \fIctlinnd\fR\|(8).
.SH "BUGS"
.IX Header "BUGS"
\&\fBinnd\fR normally attempts to strip \s-1IP\s0 options from incoming connections,
since it uses IP-based authentication and source routing can confuse that.
However, this doesn't work on all systems, and it doesn't work at all in
the presence of IPv6 support (and is disabled in that case).  Hence, if
using \fBinnd\fR with IPv6 support, make sure that your kernel or router
disables source routing.
.SH "HISTORY"
.IX Header "HISTORY"
Written by Rich \f(CW$alz\fR <rsalz@uunet.uu.net> for InterNetNews.
.PP
$Id$
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIactive\fR\|(5), \fIctlinnd\fR\|(8), \fIdbz\fR\|(3), \fIhistory\fR\|(5), \fIincoming.conf\fR\|(5), \fIinn.conf\fR\|(5),
\&\fIinnbind\fR\|(8), \fInewsfeeds\fR\|(5), \fInnrpd\fR\|(8), \fIrnews\fR\|(1), \fIsyslog\fR\|(3).
